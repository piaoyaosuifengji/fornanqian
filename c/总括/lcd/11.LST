C51 COMPILER V8.05a   11                                                                   11/30/2012 13:32:37 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE 11
OBJECT MODULE PLACED IN 11.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE 11.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1                                     #include<reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char      //定义unsighed 为unsigned char
   4          #define uint unsigned int         //定义uint 为 int
   5          uchar code table2[]={"Tian  Gui      "};
   6          uchar code table1[]={'0','1','2','3','4','5','6','7','8','9'};
   7          uchar code table3[]={"key-js is :   "};
   8          uchar qian,bai,shi,ge;  //千，百，十，个位
   9          signed int num=0;
  10          sbit en=P2^2;
  11          sbit rs=P2^0;                   
  12          sbit rw=P2^1;
  13          
  14          void Delay(uint xx)
  15          {
  16   1      uint yy;
  17   1      while(xx--)
  18   1      for(yy=0;yy<11;yy++);
  19   1      }
  20          
  21          
  22          void write_com(uchar com)        //读状态用了
  23          {
  24   1        rw=0;
  25   1        rs=0;
  26   1        P0=com;
  27   1        Delay(5);
  28   1        en=1;
  29   1        Delay(5);
  30   1        en=0;
  31   1      }
  32          
  33          void init()        //.............初始化
  34          {
  35   1        en=0;
  36   1        rs=0;
  37   1        write_com(0x38);
  38   1        write_com(0x0c);
  39   1        write_com(0x06);
  40   1        write_com(0x01);
  41   1        write_com(0x80);
  42   1      }
  43          
  44          
  45          
  46          void write_date(uchar date)     //向p1口送数据       用了
  47          {
  48   1        rw=0;
  49   1        rs=1;
  50   1        P0=date;
  51   1        Delay(5);
  52   1        en=1;
  53   1        Delay(5);
  54   1        en=0; 
  55   1      }
C51 COMPILER V8.05a   11                                                                   11/30/2012 13:32:37 PAGE 2   

  56          
  57          
  58          
  59          void num_cl()
  60          {
  61   1      if(num==100)
  62   1      {num=0;}
  63   1      shi=num%100/10;
  64   1      ge=num%10;
  65   1      }
  66          
  67          
  68          
  69          void display()
  70          {
  71   1      write_com(0xce);        
  72   1      write_date(table1[shi]);
  73   1      write_com(0xcf);        
  74   1      write_date(table1[ge]);
  75   1      }
  76          
  77          
  78          void Disp_tg(uchar com,const uchar * pt,uchar num)
  79          {
  80   1          uchar i;            
  81   1              write_com(com); 
  82   1            for(i=0;i<num;i++) 
  83   1            write_date(*(pt++)); 
  84   1      }
  85          
  86          
  87          void main()
  88          {
  89   1      init();
  90   1      TMOD=0x06;
  91   1      IT1=1;
  92   1      TH0=256-1;
  93   1      TL0=256-1;
  94   1      IP=0x08;
  95   1      IE=0X86;
  96   1      TR0=1;
  97   1      Disp_tg(0x80,table2,16);
  98   1      Disp_tg(0xc0,table3,16);
  99   1      num_cl();
 100   1      display();
 101   1      while(1) {
 102   2      if(num==100)
 103   2       num=0;
 104   2      num_cl();
 105   2      display();
 106   2      }
 107   1      
 108   1      }
 109          
 110           void time0() interrupt 1 using 2{
 111   1       TH0=256-1;
 112   1       TL0=256-1;
 113   1       num++;
 114   1      
 115   1      }
 116          
 117           void service_int1() interrupt  2 using 2{
C51 COMPILER V8.05a   11                                                                   11/30/2012 13:32:37 PAGE 3   

 118   1       num=0;
 119   1       }
 120          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    320    ----
   CONSTANT SIZE    =     41    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
