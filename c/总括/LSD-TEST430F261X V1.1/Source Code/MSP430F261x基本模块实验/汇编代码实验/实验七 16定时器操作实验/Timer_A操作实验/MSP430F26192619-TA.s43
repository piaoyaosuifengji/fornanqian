/*******************************************************************************
// 版权:   杭州利尔达科技有限公司
// 文件名:MSP430x261x_ta.c
// 版本：V1.0
// 工作环境:IAR Embedded Workbench Evaluation for MSP430 4.10A
// 作者:Huanglongsong
// 描述：Timer_A演示，TA初始化为连续计数模式，CPU被禁止，当TAR计数到CCR0(50000)时，
// 产生一次中断(TA_ISR)，触发P5.7输出翻转
//  ACLK = n/a, MCLK = SMCLK = TACLK = default DCO ~1.045MHz
// 生成日期:2008年11月
//
//           MSP430F261x
//         ---------------
//     /|\|            XIN|-
//      | |               |
//      --|RST        XOUT|-
//        |               |
//        |           P5.7|-->LED
//
//
******************************************************************************/
#include  <msp430x26x.h>
;-------------------------------------------------------------------------------
            RSEG    CSTACK                  ; 定义堆栈区
;-------------------------------------------------------------------------------
            RSEG    CODE                    ; 定义代码段
;-----------------------------------------------------------------------------
RESET       mov.w   #SFE(CSTACK),SP         ; 初始化堆栈区
StopWDT     mov.w   #WDTPW+WDTHOLD,&WDTCTL  ; 关闭看门狗

SetupP5     bis.b   #BIT7,&P5DIR            ; P5.7 输出
SetupC0     mov.w   #CCIE,&TACCTL0          ; 使能比较中断
            mov.w   #50000,&TACCR0          ; CCR0赋值
SetupTA     mov.w   #TASSEL_2+MC_2,&TACTL   ; SMCLK,连续计数模式
                                            ;						
Mainloop    bis.w   #CPUOFF+GIE,SR          ; LPM0
            nop                             ; 
                                            ;
;------------------------------------------------------------------------------
; Timer_A中断程序
;------------------------------------------------------------------------------
TA0_ISR
            xor.b   #BIT7,&P5OUT            ; 取反P5.7
            add.w   #50000,&TACCR0          ; CCR0赋值
            reti                            ;		
                                            ;
;------------------------------------------------------------------------------
; 中断向量表
;------------------------------------------------------------------------------
            COMMON  INTVEC
            ORG     RESET_VECTOR            ; 复位向量
            DW      RESET                   ;
            ORG     TIMERA0_VECTOR          ; Timer_A中断
            DW      TA0_ISR                 ;
            END
